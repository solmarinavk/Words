<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#7ED957">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Coco Words">
  <link rel="manifest" href="manifest.json">
  <title>Coco Words</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --lime: #7ED957;
      --coral: #FF6B6B;
      --yellow: #FFD93D;
      --purple: #B8A9E8;
      --pink: #FF9FF3;
      --blue: #5B9FFF;
      --orange: #FFA94D;
      --mint: #69DB7C;
      --white: #FFFFFF;
      --dark: #2D3436;
      --gray: #636E72;
    }

    body {
      font-family: 'Nunito', sans-serif;
      background: var(--white);
      color: var(--dark);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .container { max-width: 480px; margin: 0 auto; padding: 16px; padding-bottom: 90px; }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      background: var(--lime);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      font-size: 1.6rem;
      font-weight: 900;
      color: var(--white);
      text-shadow: 2px 2px 0 rgba(0,0,0,0.1);
    }

    .logo span { color: var(--yellow); }

    .streak-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      background: var(--yellow);
      padding: 8px 16px;
      border-radius: 50px;
      font-weight: 800;
      color: var(--dark);
      font-size: 0.9rem;
    }

    /* Navigation */
    .nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--white);
      display: flex;
      justify-content: space-around;
      padding: 12px 0 24px;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
      z-index: 100;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: var(--gray);
      text-decoration: none;
      font-size: 0.7rem;
      font-weight: 700;
      cursor: pointer;
      background: none;
      border: none;
      transition: all 0.3s;
      padding: 4px 12px;
      border-radius: 12px;
    }

    .nav-item.active {
      color: var(--lime);
      background: rgba(126, 217, 87, 0.1);
    }

    .nav-item svg { width: 26px; height: 26px; margin-bottom: 4px; }

    /* Cards */
    .card {
      background: var(--white);
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .card-title {
      font-size: 1.1rem;
      margin-bottom: 16px;
      font-weight: 800;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Level Display */
    .level-display {
      text-align: center;
      padding: 30px;
      background: linear-gradient(135deg, var(--lime) 0%, var(--mint) 100%);
      border-radius: 32px;
      margin-bottom: 20px;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .level-display::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
    }

    .level-circle {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: rgba(255,255,255,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      position: relative;
    }

    .level-number {
      font-size: 2.5rem;
      font-weight: 900;
    }

    .level-name { font-size: 1.3rem; font-weight: 800; margin-bottom: 5px; }
    .xp-text { opacity: 0.9; font-weight: 600; font-size: 0.95rem; }

    /* Buttons */
    .btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: 16px;
      font-size: 1rem;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .btn:active { transform: scale(0.97); }

    .btn-primary { background: var(--lime); color: white; }
    .btn-secondary { background: #F1F3F4; color: var(--dark); }
    .btn-coral { background: var(--coral); color: white; }
    .btn-purple { background: var(--purple); color: white; }
    .btn-yellow { background: var(--yellow); color: var(--dark); }
    .btn-pink { background: var(--pink); color: white; }

    .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; }

    /* Stats */
    .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }

    .stat-item {
      padding: 20px;
      border-radius: 20px;
      text-align: center;
    }

    .stat-item:nth-child(1) { background: var(--yellow); }
    .stat-item:nth-child(2) { background: var(--coral); color: white; }
    .stat-item:nth-child(3) { background: var(--purple); color: white; }
    .stat-item:nth-child(4) { background: var(--lime); color: white; }

    .stat-value { font-size: 2rem; font-weight: 900; }
    .stat-label { font-size: 0.8rem; font-weight: 700; margin-top: 4px; opacity: 0.9; }

    /* Flashcard */
    .flashcard-container { perspective: 1000px; margin: 20px 0; }

    .flashcard {
      width: 100%;
      min-height: 280px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s;
      cursor: pointer;
    }

    .flashcard.flipped { transform: rotateY(180deg); }

    .flashcard-face {
      position: absolute;
      width: 100%;
      height: 100%;
      min-height: 280px;
      backface-visibility: hidden;
      border-radius: 28px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 30px;
      text-align: center;
    }

    .flashcard-front {
      background: linear-gradient(135deg, var(--purple) 0%, #9B8FD9 100%);
      color: white;
    }

    .flashcard-back {
      background: linear-gradient(135deg, var(--coral) 0%, #FF8787 100%);
      color: white;
      transform: rotateY(180deg);
    }

    .flashcard-word { font-size: 2.2rem; font-weight: 900; margin-bottom: 8px; }
    .flashcard-type { opacity: 0.8; font-size: 1rem; font-weight: 700; }

    .flashcard-level {
      position: absolute;
      top: 16px;
      right: 16px;
      background: var(--yellow);
      padding: 6px 14px;
      border-radius: 50px;
      font-size: 0.8rem;
      font-weight: 800;
      color: var(--dark);
    }

    .flashcard-hint {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-top: 24px;
      font-weight: 600;
    }

    /* Quiz Progress */
    .quiz-progress { display: flex; gap: 6px; margin-bottom: 20px; }

    .quiz-dot {
      flex: 1;
      height: 8px;
      border-radius: 50px;
      background: #E9ECEF;
    }

    .quiz-dot.completed { background: var(--lime); }
    .quiz-dot.current { background: var(--yellow); }
    .quiz-dot.wrong { background: var(--coral); }

    /* Quiz Options */
    .quiz-card {
      background: linear-gradient(135deg, var(--blue) 0%, #74B3FF 100%);
      border-radius: 28px;
      padding: 30px;
      text-align: center;
      color: white;
      margin-bottom: 20px;
    }

    .quiz-question { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; opacity: 0.9; }
    .quiz-word { font-size: 2rem; font-weight: 900; }

    .quiz-option {
      width: 100%;
      padding: 16px 20px;
      margin-bottom: 10px;
      background: var(--white);
      border: none;
      border-radius: 14px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
      font-family: inherit;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .quiz-option:active { transform: scale(0.98); }
    .quiz-option.correct { background: var(--lime); color: white; }
    .quiz-option.wrong { background: var(--coral); color: white; }

    /* Views */
    .view { display: none; }
    .view.active { display: block; }

    /* Modal */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
      padding: 20px;
    }

    .modal.active { display: flex; }

    .modal-content {
      background: var(--white);
      border-radius: 28px;
      padding: 32px;
      text-align: center;
      max-width: 320px;
      width: 100%;
    }

    .modal-icon { font-size: 4rem; margin-bottom: 16px; }
    .modal-title { font-size: 1.4rem; margin-bottom: 8px; font-weight: 900; }
    .modal-text { color: var(--gray); margin-bottom: 20px; font-weight: 600; }

    /* Level selector */
    .level-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 16px 0; }

    .level-btn {
      padding: 12px 8px;
      border-radius: 12px;
      border: none;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
      font-size: 0.85rem;
    }

    .level-btn.active { transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }

    .level-a1 { background: var(--lime); color: white; }
    .level-a2 { background: var(--blue); color: white; }
    .level-b1 { background: var(--purple); color: white; }
    .level-b2 { background: var(--coral); color: white; }
    .level-c1 { background: var(--orange); color: white; }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate { animation: fadeIn 0.3s ease; }

    /* Responsive */
    @media (max-width: 380px) {
      .flashcard-word { font-size: 1.8rem; }
      .quiz-word { font-size: 1.6rem; }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="logo">coco<span>words</span></div>
    <div class="streak-badge">
      <span>üî•</span>
      <span id="streakCount">0</span>
    </div>
  </header>

  <div class="container">
    <!-- Home View -->
    <div id="homeView" class="view active">
      <div class="level-display">
        <div class="level-circle">
          <span class="level-number" id="currentLevel">A1</span>
        </div>
        <div class="level-name" id="levelName">Principiante</div>
        <div class="xp-text"><span id="currentXP">0</span> / <span id="nextXP">500</span> XP</div>
      </div>

      <div class="card">
        <div class="card-title">üìä Tu progreso</div>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value" id="wordsLearned">0</div>
            <div class="stat-label">Palabras</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="quizzesDone">0</div>
            <div class="stat-label">Quizzes</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="accuracy">0%</div>
            <div class="stat-label">Precisi√≥n</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="streak">0</div>
            <div class="stat-label">Racha</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">üéØ Nivel a practicar</div>
        <div class="level-grid">
          <button class="level-btn level-a1 active" onclick="setLevel('A1')">A1</button>
          <button class="level-btn level-a2" onclick="setLevel('A2')">A2</button>
          <button class="level-btn level-b1" onclick="setLevel('B1')">B1</button>
          <button class="level-btn level-b2" onclick="setLevel('B2')">B2</button>
          <button class="level-btn level-c1" onclick="setLevel('C1')">C1</button>
        </div>
      </div>

      <div class="card">
        <div class="card-title">üöÄ ¬°Comienza a aprender!</div>
        <button class="btn btn-primary" onclick="startFlashcards()" style="margin-bottom: 12px;">
          üìö Flashcards
        </button>
        <button class="btn btn-coral" onclick="startQuiz()">
          üß† Quiz
        </button>
      </div>
    </div>

    <!-- Flashcard View -->
    <div id="flashcardView" class="view">
      <div class="quiz-progress" id="flashcardProgress"></div>

      <div class="flashcard-container">
        <div class="flashcard" id="flashcard" onclick="flipCard()">
          <div class="flashcard-face flashcard-front">
            <span class="flashcard-level" id="fcLevel">A1</span>
            <div class="flashcard-word" id="fcWord">Word</div>
            <div class="flashcard-type" id="fcType">noun</div>
            <div class="flashcard-hint">üëÜ Toca para ver significado</div>
          </div>
          <div class="flashcard-face flashcard-back">
            <div class="flashcard-word" id="fcMeaning">Significado</div>
            <div class="flashcard-hint">¬øLa conoc√≠as?</div>
          </div>
        </div>
      </div>

      <div class="btn-group">
        <button class="btn btn-coral" onclick="markWord(false)">‚ùå No la s√©</button>
        <button class="btn btn-primary" onclick="markWord(true)">‚úÖ La s√©</button>
      </div>

      <button class="btn btn-secondary" onclick="goHome()" style="margin-top: 12px;">
        ‚Üê Volver
      </button>
    </div>

    <!-- Quiz View -->
    <div id="quizView" class="view">
      <div class="quiz-progress" id="quizProgress"></div>

      <div class="quiz-card">
        <span class="flashcard-level" id="quizLevel" style="position:static; display:inline-block; margin-bottom:12px;">A1</span>
        <div class="quiz-question">¬øQu√© significa...</div>
        <div class="quiz-word" id="quizWord">word</div>
      </div>

      <div id="quizOptions"></div>

      <button class="btn btn-secondary" onclick="goHome()" style="margin-top: 8px;">
        ‚Üê Volver
      </button>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="nav">
    <button class="nav-item active" onclick="showView('home')">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
      Inicio
    </button>
    <button class="nav-item" onclick="startFlashcards()">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
      Tarjetas
    </button>
    <button class="nav-item" onclick="startQuiz()">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
      Quiz
    </button>
  </nav>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <div class="modal-icon" id="modalIcon">üéâ</div>
      <h3 class="modal-title" id="modalTitle">¬°Bien hecho!</h3>
      <p class="modal-text" id="modalText">Completaste la sesi√≥n</p>
      <button class="btn btn-primary" onclick="closeModal()">Continuar</button>
    </div>
  </div>

  <script src="words.js"></script>
  <script>
    // ============ APP STATE ============
    let state = {
      xp: 0,
      level: 'A1',
      selectedLevel: 'A1',
      streak: 0,
      lastStudyDate: null,
      wordProgress: {},
      quizzesDone: 0,
      correctAnswers: 0,
      totalAnswers: 0
    };

    const LEVELS = {
      'A1': { name: 'Principiante', xpNeeded: 0 },
      'A2': { name: 'Elemental', xpNeeded: 500 },
      'B1': { name: 'Intermedio', xpNeeded: 1500 },
      'B2': { name: 'Intermedio Alto', xpNeeded: 3500 },
      'C1': { name: 'Avanzado', xpNeeded: 7000 }
    };

    let currentSession = { words: [], index: 0, correct: 0, mode: 'flashcard' };

    // ============ INITIALIZATION ============
    function init() {
      loadState();
      updateUI();
      updateStreak();

      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js').catch(() => {});
      }
    }

    function loadState() {
      const saved = localStorage.getItem('cocowords_state');
      if (saved) {
        try {
          state = { ...state, ...JSON.parse(saved) };
        } catch (e) {}
      }
    }

    function saveState() {
      localStorage.setItem('cocowords_state', JSON.stringify(state));
    }

    function updateStreak() {
      const today = new Date().toDateString();
      if (state.lastStudyDate !== today) {
        const yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);
        if (state.lastStudyDate === yesterday.toDateString()) {
          state.streak++;
        } else if (state.lastStudyDate !== today) {
          state.streak = 1;
        }
        state.lastStudyDate = today;
        saveState();
      }
    }

    // ============ UI UPDATES ============
    function updateUI() {
      // Calculate level
      let currentLevel = 'A1';
      for (const [lvl, data] of Object.entries(LEVELS)) {
        if (state.xp >= data.xpNeeded) currentLevel = lvl;
      }
      state.level = currentLevel;

      // Update displays
      document.getElementById('currentLevel').textContent = currentLevel;
      document.getElementById('levelName').textContent = LEVELS[currentLevel].name;
      document.getElementById('currentXP').textContent = state.xp;

      const levelKeys = Object.keys(LEVELS);
      const nextLevelIdx = levelKeys.indexOf(currentLevel) + 1;
      const nextXP = nextLevelIdx < levelKeys.length ? LEVELS[levelKeys[nextLevelIdx]].xpNeeded : state.xp;
      document.getElementById('nextXP').textContent = nextXP;

      // Stats
      document.getElementById('wordsLearned').textContent = Object.keys(state.wordProgress).length;
      document.getElementById('quizzesDone').textContent = state.quizzesDone;
      document.getElementById('streak').textContent = state.streak;
      document.getElementById('streakCount').textContent = state.streak;

      const accuracy = state.totalAnswers > 0
        ? Math.round((state.correctAnswers / state.totalAnswers) * 100)
        : 0;
      document.getElementById('accuracy').textContent = accuracy + '%';

      saveState();
    }

    // ============ NAVIGATION ============
    function showView(viewName) {
      document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

      const viewId = viewName === 'home' ? 'homeView' : viewName + 'View';
      document.getElementById(viewId)?.classList.add('active');

      if (viewName === 'home') {
        document.querySelector('.nav-item')?.classList.add('active');
      }
    }

    function goHome() {
      showView('home');
      updateUI();
    }

    // ============ LEVEL SELECTION ============
    function setLevel(level) {
      state.selectedLevel = level;
      document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      saveState();
    }

    // ============ FLASHCARDS ============
    function startFlashcards() {
      const levelWords = WORDS.filter(w => w.l === state.selectedLevel);
      if (levelWords.length === 0) {
        showModal('üòÖ', 'Sin palabras', 'No hay palabras para este nivel');
        return;
      }

      currentSession = {
        words: shuffleArray(levelWords).slice(0, 10),
        index: 0,
        correct: 0,
        mode: 'flashcard'
      };

      showView('flashcard');
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      document.querySelectorAll('.nav-item')[1]?.classList.add('active');
      renderFlashcard();
    }

    function renderFlashcard() {
      const word = currentSession.words[currentSession.index];
      if (!word) return endSession();

      document.getElementById('flashcard').classList.remove('flipped');
      document.getElementById('fcWord').textContent = word.w;
      document.getElementById('fcType').textContent = word.t || '';
      document.getElementById('fcLevel').textContent = word.l;
      document.getElementById('fcMeaning').textContent = word.m || '‚Äî';

      // Progress
      const progressHTML = currentSession.words.map((_, i) => {
        let cls = 'quiz-dot';
        if (i < currentSession.index) cls += ' completed';
        else if (i === currentSession.index) cls += ' current';
        return `<div class="${cls}"></div>`;
      }).join('');
      document.getElementById('flashcardProgress').innerHTML = progressHTML;
    }

    function flipCard() {
      document.getElementById('flashcard').classList.toggle('flipped');
    }

    function markWord(known) {
      const word = currentSession.words[currentSession.index];

      if (known) {
        state.wordProgress[word.w] = (state.wordProgress[word.w] || 0) + 1;
        state.xp += 10;
        currentSession.correct++;
      }

      state.totalAnswers++;
      if (known) state.correctAnswers++;

      currentSession.index++;

      if (currentSession.index >= currentSession.words.length) {
        endSession();
      } else {
        renderFlashcard();
      }
    }

    // ============ QUIZ ============
    function startQuiz() {
      const levelWords = WORDS.filter(w => w.l === state.selectedLevel && w.m);
      if (levelWords.length < 4) {
        showModal('üòÖ', 'Pocas palabras', 'Necesitas al menos 4 palabras con traducci√≥n');
        return;
      }

      currentSession = {
        words: shuffleArray(levelWords).slice(0, 10),
        index: 0,
        correct: 0,
        mode: 'quiz'
      };

      showView('quiz');
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      document.querySelectorAll('.nav-item')[2]?.classList.add('active');
      renderQuiz();
    }

    function renderQuiz() {
      const word = currentSession.words[currentSession.index];
      if (!word) return endSession();

      document.getElementById('quizWord').textContent = word.w;
      document.getElementById('quizLevel').textContent = word.l;

      // Generate options
      const allMeanings = WORDS.filter(w => w.m && w.m !== word.m).map(w => w.m);
      const wrongOptions = shuffleArray(allMeanings).slice(0, 3);
      const options = shuffleArray([word.m, ...wrongOptions]);

      const optionsHTML = options.map(opt =>
        `<button class="quiz-option" onclick="checkAnswer(this, '${escapeHtml(opt)}', '${escapeHtml(word.m)}')">${opt}</button>`
      ).join('');

      document.getElementById('quizOptions').innerHTML = optionsHTML;

      // Progress
      const progressHTML = currentSession.words.map((_, i) => {
        let cls = 'quiz-dot';
        if (i < currentSession.index) cls += ' completed';
        else if (i === currentSession.index) cls += ' current';
        return `<div class="${cls}"></div>`;
      }).join('');
      document.getElementById('quizProgress').innerHTML = progressHTML;
    }

    function checkAnswer(btn, selected, correct) {
      const buttons = document.querySelectorAll('.quiz-option');
      buttons.forEach(b => b.disabled = true);

      state.totalAnswers++;

      if (selected === correct) {
        btn.classList.add('correct');
        state.correctAnswers++;
        state.xp += 20;
        currentSession.correct++;
        state.wordProgress[currentSession.words[currentSession.index].w] =
          (state.wordProgress[currentSession.words[currentSession.index].w] || 0) + 1;
      } else {
        btn.classList.add('wrong');
        buttons.forEach(b => {
          if (b.textContent === correct) b.classList.add('correct');
        });
      }

      setTimeout(() => {
        currentSession.index++;
        if (currentSession.index >= currentSession.words.length) {
          endSession();
        } else {
          renderQuiz();
        }
      }, 1000);
    }

    // ============ SESSION END ============
    function endSession() {
      state.quizzesDone++;
      updateUI();

      const percentage = Math.round((currentSession.correct / currentSession.words.length) * 100);
      let icon = 'üéâ';
      let title = '¬°Excelente!';

      if (percentage < 50) { icon = 'üí™'; title = '¬°Sigue practicando!'; }
      else if (percentage < 80) { icon = 'üëç'; title = '¬°Bien hecho!'; }

      showModal(icon, title, `${currentSession.correct}/${currentSession.words.length} correctas (${percentage}%)`);
    }

    // ============ MODAL ============
    function showModal(icon, title, text) {
      document.getElementById('modalIcon').textContent = icon;
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalText').textContent = text;
      document.getElementById('modal').classList.add('active');
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('active');
      goHome();
    }

    // ============ UTILITIES ============
    function shuffleArray(arr) {
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function escapeHtml(str) {
      if (!str) return '';
      return str.replace(/'/g, "\\'").replace(/"/g, '&quot;');
    }

    // Initialize
    init();
  </script>
</body>
</html>
